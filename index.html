<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>ãƒãƒ³ã‚³ã‚¯ç‰©ä»¶å€™è£œ - ãƒ¢ãƒã‚¤ãƒ«ç‰ˆ</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f8f9fa;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .tab-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex;
        }
        
        .tab-button {
            flex: 1;
            padding: 16px;
            background: white;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button.active {
            color: #1a73e8;
            border-bottom-color: #1a73e8;
            background: #f8f9ff;
        }
        
        .tab-button:active {
            background: #e8f0fe;
        }
        
        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */
        .content {
            margin-top: 58px;
            padding-bottom: 20px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* åœ°å›³ã‚¹ã‚¿ã‚¤ãƒ« */
        #map {
            width: 100%;
            height: calc(100vh - 58px);
        }
        
        /* Leafletãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
        .leaflet-popup-content-wrapper {
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .leaflet-popup-content {
            margin: 12px 14px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .popup-content h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            color: #1a73e8;
            border-bottom: 2px solid #eee;
            padding-bottom: 6px;
        }
        
        .popup-price {
            font-size: 18px;
            font-weight: bold;
            color: #d93025;
            margin: 10px 0;
        }
        
        .popup-highlight {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            padding: 8px 10px;
            border-radius: 6px;
            margin: 8px 0;
            border-left: 4px solid #ffc107;
            font-weight: bold;
            font-size: 13px;
        }
        
        .popup-detail {
            margin: 6px 0;
            font-size: 13px;
            color: #333;
        }
        
        .popup-footer {
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px dashed #ccc;
            font-size: 12px;
            color: #666;
        }
        
        .popup-link {
            display: block;
            background: linear-gradient(135deg, #1a73e8, #1557b0);
            color: white !important;
            text-align: center;
            padding: 10px 12px;
            margin-top: 10px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            font-size: 13px;
            transition: all 0.3s ease;
        }
        
        /* ç‰©ä»¶ãƒªã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ« */
        .property-list {
            padding: 16px;
        }
        
        .list-header {
            background: linear-gradient(135deg, #1a73e8, #1557b0);
            color: white;
            padding: 20px;
            margin-bottom: 16px;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(26, 115, 232, 0.2);
        }
        
        .list-header h2 {
            font-size: 22px;
            margin-bottom: 16px;
            text-align: center;
        }
        
        .legend-mobile {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .legend-item-mobile {
            display: flex;
            align-items: center;
            font-size: 13px;
            color: white;
            background: rgba(255,255,255,0.1);
            padding: 8px 12px;
            border-radius: 8px;
        }
        
        .color-indicator {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            flex-shrink: 0;
        }
        
        .property-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid #e8eaed;
        }
        
        .property-card:active {
            transform: scale(0.98);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .property-header {
            display: flex;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        
        .rank-badge {
            background: linear-gradient(135deg, #1a73e8, #1557b0);
            color: white;
            padding: 8px 14px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
            box-shadow: 0 3px 8px rgba(26, 115, 232, 0.3);
            min-width: 50px;
            text-align: center;
        }
        
        .property-name {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            line-height: 1.4;
        }
        
        .property-price {
            font-size: 24px;
            font-weight: bold;
            color: #d93025;
            margin: 16px 0;
            text-align: center;
            background: #fef7f0;
            padding: 12px;
            border-radius: 12px;
            border: 2px solid #fbbc04;
        }
        
        .property-highlight {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            padding: 12px 16px;
            border-radius: 12px;
            margin: 16px 0;
            border-left: 4px solid #ffc107;
            font-weight: 600;
            font-size: 14px;
            color: #856404;
            box-shadow: 0 2px 6px rgba(255, 193, 7, 0.2);
        }
        
        .property-details {
            margin: 12px 0;
        }
        
        .detail-row {
            display: flex;
            align-items: center;
            padding: 10px 0;
            font-size: 15px;
            color: #555;
            line-height: 1.5;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-icon {
            width: 28px;
            margin-right: 12px;
            flex-shrink: 0;
            font-size: 16px;
        }
        
        .property-footer {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 2px dashed #ddd;
            font-size: 14px;
            color: #666;
            text-align: center;
            background: #f8f9fa;
            padding: 16px;
            border-radius: 8px;
        }
        
        .view-button {
            display: block;
            width: 100%;
            padding: 16px;
            margin-top: 16px;
            background: linear-gradient(135deg, #1a73e8, #1557b0);
            color: white;
            text-align: center;
            border-radius: 12px;
            text-decoration: none;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 4px 16px rgba(26, 115, 232, 0.3);
            transition: all 0.3s ease;
        }
        
        .view-button:active {
            transform: scale(0.97);
            box-shadow: 0 2px 8px rgba(26, 115, 232, 0.3);
        }
        
        /* ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ã‚«ãƒ¼ç•ªå· */
        .custom-marker {
            background-color: white;
            border: 3px solid white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: white;
            box-shadow: 0 3px 8px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <div class="tab-container">
        <button class="tab-button active" onclick="switchTab('map')">ğŸ—º åœ°å›³</button>
        <button class="tab-button" onclick="switchTab('list')">ğŸ“‹ ä¸€è¦§</button>
    </div>
    
    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="content">
        <!-- åœ°å›³ã‚¿ãƒ– -->
        <div id="map-tab" class="tab-content active">
            <div id="map"></div>
        </div>
        
        <!-- ä¸€è¦§ã‚¿ãƒ– -->
        <div id="list-tab" class="tab-content">
            <div class="property-list">
                <div class="list-header">
                    <h2>ğŸ† æœ€çµ‚å€™è£œ7ç‰©ä»¶</h2>
                    <div class="legend-mobile">
                        <div class="legend-item-mobile">
                            <span class="color-indicator" style="background: #e74c3c;"></span>
                            1ä½ï¼šæœ€åºƒ68ã¡
                        </div>
                        <div class="legend-item-mobile">
                            <span class="color-indicator" style="background: #e67e22;"></span>
                            2-3ä½ï¼š60ã¡å°
                        </div>
                        <div class="legend-item-mobile">
                            <span class="color-indicator" style="background: #f39c12;"></span>
                            4-5ä½ï¼šã‚³ã‚¹ãƒ‘â—
                        </div>
                        <div class="legend-item-mobile">
                            <span class="color-indicator" style="background: #27ae60;"></span>
                            6-7ä½ï¼š60ã¡
                        </div>
                    </div>
                </div>
                
                <!-- ç‰©ä»¶ã‚«ãƒ¼ãƒ‰ï¼ˆãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è‡ªå‹•ç”Ÿæˆï¼‰ -->
                <div id="property-cards"></div>
            </div>
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>

    <script>
        // ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ï¼ˆæŒ‡å®šåº§æ¨™ï¼‹ãƒªãƒ³ã‚¯å®Œå‚™ï¼‰
        const properties = [
            {
                rank: 1,
                name: "Belle Grand Rama 9",
                lat: 13.760237221313165,
                lng: 100.56921625457834,
                size: 68,
                bedrooms: 2,
                bathrooms: 1,
                price: 35000,
                station: "MRT Phra Ram 9é§… å¾’æ­©5-8åˆ†",
                age: "ç¯‰12å¹´",
                features: "ãƒ—ãƒ¼ãƒ«ãƒ»ãƒ•ã‚£ãƒƒãƒˆãƒã‚¹ãƒ»æ•·åœ°å†…å•†æ¥­æ–½è¨­",
                color: "#e74c3c",
                highlight: "ä»Šå›æœ€å¤§ã®åºƒã•ï¼68ã¡",
                propertyUrl: "https://www.facebook.com/groups/6521519787867197/posts/25934857656106787/"
            },
            {
                rank: 2,
                name: "Ideo Q Phayathai",
                lat: 13.755906097726632,
                lng: 100.53277004848589,
                size: 65,
                bedrooms: 2,
                bathrooms: 2,
                price: 35000,
                station: "BTS Phaya Thaié§… å¾’æ­©2-3åˆ†",
                age: "ç¯‰15å¹´",
                features: "ãƒ—ãƒ¼ãƒ«ãƒ»ç©ºæ¸¯ç·šç›´çµ",
                color: "#e67e22",
                highlight: "ç©ºæ¸¯ã‚¢ã‚¯ã‚»ã‚¹æŠœç¾¤",
                propertyUrl: "https://propertyscout.co.th/en/2-br-condo-ideo-q-phayathai-near-bts-phaya-thai-1852140/"
            },
            {
                rank: 3,
                name: "The Address Phayathai",
                lat: 13.759685947389874,
                lng: 100.5317286545783,
                size: 63,
                bedrooms: 2,
                bathrooms: 1,
                price: 25000,
                station: "BTS Phaya Thaié§… å¾’æ­©5åˆ†",
                age: "ç¯‰14å¹´",
                features: "ã‚µã‚¦ãƒŠãƒ»ãƒ—ãƒ¼ãƒ«",
                color: "#e67e22",
                highlight: "æœ€å¼·ã‚³ã‚¹ãƒ‘ï¼2.52ã¡/1000B",
                propertyUrl: "https://propertyscout.co.th/en/2-br-condo-the-address-phayathai-near-bts-phaya-thai-2351890/"
            },
            {
                rank: 4,
                name: "Thru Thonglor",
                lat: 13.744439248847318,
                lng: 100.58543526807097,
                size: 62.4,
                bedrooms: 2,
                bathrooms: 2,
                price: 25000,
                station: "BTS Thong Loé§…ï¼ˆã‚·ãƒ£ãƒˆãƒ«æœ‰ï¼‰",
                age: "ç¯‰12å¹´",
                features: "ãƒ—ãƒ¼ãƒ«ãƒ»ãƒˆãƒ³ãƒ­ãƒ¼ã‚¨ãƒªã‚¢",
                color: "#f39c12",
                highlight: "ãŠã—ã‚ƒã‚Œã‚¨ãƒªã‚¢ã§ç ´æ ¼ä¾¡æ ¼",
                propertyUrl: "https://www.facebook.com/groups/1046291836187649/posts/2191321105018044/"
            },
            {
                rank: 5,
                name: "The Line Vibe",
                lat: 13.817796190281511,
                lng: 100.56709881040038,
                size: 60,
                bedrooms: 2,
                bathrooms: 2,
                price: 25000,
                station: "BTS Ha Yaek Lat Phraoé§… å¾’æ­©5åˆ†",
                age: "æ¯”è¼ƒçš„æ–°ã—ã„",
                features: "ãƒ—ãƒ¼ãƒ«ãƒ»Lineãƒ–ãƒ©ãƒ³ãƒ‰",
                color: "#f39c12",
                highlight: "60ã¡ã§2ãƒã‚¹ãƒ«ãƒ¼ãƒ ",
                propertyUrl: "https://www.facebook.com/groups/661207761960248/posts/1383242806423403/"
            },
            {
                rank: 6,
                name: "Ideo O2",
                lat: 13.67342536698527,
                lng: 100.60445935773538,
                size: 60,
                bedrooms: 2,
                bathrooms: 2,
                price: 28000,
                station: "BTS Bang Naé§… å¾’æ­©5-10åˆ†",
                age: "ç¯‰7å¹´",
                features: "3ã¤ã®ãƒ—ãƒ¼ãƒ«ãƒ»ãƒªã‚¾ãƒ¼ãƒˆç´šæ–½è¨­",
                color: "#27ae60",
                highlight: "ãƒªã‚¾ãƒ¼ãƒˆä¸¦ã¿ã®å…±ç”¨æ–½è¨­",
                propertyUrl: "https://www.facebook.com/groups/1046291836187649/posts/2192147568268731/"
            },
            {
                rank: 7,
                name: "M Jatujak",
                lat: 13.797914490603361,
                lng: 100.55174575457877,
                size: 60,
                bedrooms: 2,
                bathrooms: 2,
                price: 30000,
                station: "BTS Mo Chit/MRT Chatuchak Parké§… å¾’æ­©5åˆ†",
                age: "ç¯‰7å¹´",
                features: "ãƒ—ãƒ¼ãƒ«ãƒ»2è·¯ç·šåˆ©ç”¨å¯",
                color: "#27ae60",
                highlight: "2è·¯ç·šã‚¢ã‚¯ã‚»ã‚¹",
                propertyUrl: "https://www.facebook.com/groups/2157264477895406/posts/4286143078340858/"
            }
        ];

        let map;

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        function switchTab(tab) {
            const tabs = document.querySelectorAll('.tab-button');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(t => t.classList.remove('active'));
            contents.forEach(c => c.classList.remove('active'));
            
            if (tab === 'map') {
                tabs[0].classList.add('active');
                document.getElementById('map-tab').classList.add('active');
                // åœ°å›³ã®ãƒªã‚µã‚¤ã‚º
                setTimeout(() => {
                    if (map) {
                        map.invalidateSize();
                    }
                }, 100);
            } else {
                tabs[1].classList.add('active');
                document.getElementById('list-tab').classList.add('active');
            }
        }

        // ç‰©ä»¶ã‚«ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³ä»˜ãï¼‰
        function generatePropertyCards() {
            const container = document.getElementById('property-cards');
            
            properties.forEach(prop => {
                const costPerformance = (prop.size / (prop.price / 1000)).toFixed(2);
                
                const card = document.createElement('div');
                card.className = 'property-card';
                card.innerHTML = `
                    <div class="property-header">
                        <div class="rank-badge">${prop.rank}ä½</div>
                        <div class="property-name">${prop.name}</div>
                    </div>
                    
                    <div class="property-price">ğŸ’° ${prop.price.toLocaleString()}ãƒãƒ¼ãƒ„/æœˆ</div>
                    
                    <div class="property-highlight">${prop.highlight}</div>
                    
                    <div class="property-details">
                        <div class="detail-row">
                            <span class="detail-icon">ğŸ“</span>
                            <span><strong>${prop.size}ã¡</strong> | ğŸ› ${prop.bedrooms}BR | ğŸš¿ ${prop.bathrooms}Bath</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-icon">ğŸš‰</span>
                            <span>${prop.station}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-icon">ğŸ—</span>
                            <span>${prop.age}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-icon">âœ¨</span>
                            <span>${prop.features}</span>
                        </div>
                    </div>
                    
                    <div class="property-footer">
                        ğŸ’µ ã‚³ã‚¹ãƒ‘: <strong>${costPerformance}ã¡/1000B</strong>
                    </div>
                    
                    <a href="${prop.propertyUrl}" target="_blank" rel="noopener noreferrer" class="view-button">
                        ğŸ”— ç‰©ä»¶è©³ç´°ã‚’è¦‹ã‚‹
                    </a>
                `;
                
                container.appendChild(card);
            });
        }

        // Leafletåœ°å›³åˆæœŸåŒ–
        function initMap() {
            // åœ°å›³ä½œæˆï¼ˆãƒãƒ³ã‚³ã‚¯ä¸­å¿ƒï¼‰
            map = L.map('map').setView([13.76, 100.57], 12);

            // OpenStreetMapã‚¿ã‚¤ãƒ«è¿½åŠ 
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 19
            }).addTo(map);

            // å…¨ãƒãƒ¼ã‚«ãƒ¼ã®å¢ƒç•Œè¨­å®šç”¨
            const bounds = [];

            properties.forEach(property => {
                const costPerformance = (property.size / (property.price / 1000)).toFixed(2);

                // å††å½¢ãƒãƒ¼ã‚«ãƒ¼ä½œæˆ
                const marker = L.circleMarker([property.lat, property.lng], {
                    radius: 14,
                    fillColor: property.color,
                    color: "white",
                    weight: 3,
                    opacity: 1,
                    fillOpacity: 0.9
                }).addTo(map);

                // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—å†…å®¹ï¼ˆãƒªãƒ³ã‚¯ä»˜ãï¼‰
                const popupContent = `
                    <div class="popup-content">
                        <h3>${property.rank}ä½: ${property.name}</h3>
                        <div class="popup-price">ğŸ’° ${property.price.toLocaleString()}ãƒãƒ¼ãƒ„/æœˆ</div>
                        <div class="popup-highlight">${property.highlight}</div>
                        <div class="popup-detail">ğŸ“ ${property.size}ã¡ | ğŸ› ${property.bedrooms}BR | ğŸš¿ ${property.bathrooms}Bath</div>
                        <div class="popup-detail">ğŸš‰ ${property.station}</div>
                        <div class="popup-detail">ğŸ— ${property.age}</div>
                        <div class="popup-detail">âœ¨ ${property.features}</div>
                        <div class="popup-footer">ğŸ’µ ã‚³ã‚¹ãƒ‘: <strong>${costPerformance}ã¡/1000B</strong></div>
                        <a href="${property.propertyUrl}" target="_blank" rel="noopener noreferrer" class="popup-link">
                            ğŸ”— ç‰©ä»¶è©³ç´°ã‚’è¦‹ã‚‹
                        </a>
                    </div>
                `;

                marker.bindPopup(popupContent, {
                    maxWidth: 300,
                    className: 'custom-popup'
                });

                // é †ä½ç•ªå·ãƒ©ãƒ™ãƒ«è¿½åŠ 
                const rankIcon = L.divIcon({
                    className: 'custom-marker',
                    html: `<div class="custom-marker" style="background-color: ${property.color};">${property.rank}</div>`,
                    iconSize: [28, 28],
                    iconAnchor: [14, 14]
                });

                L.marker([property.lat, property.lng], {
                    icon: rankIcon,
                    interactive: false
                }).addTo(map);

                bounds.push([property.lat, property.lng]);
            });

            // å…¨ç‰©ä»¶ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ã‚ºãƒ¼ãƒ èª¿æ•´
            if (bounds.length > 0) {
                map.fitBounds(bounds, { padding: [50, 50] });
            }
        }

        // åˆæœŸåŒ–å‡¦ç†
        window.addEventListener('load', function() {
            generatePropertyCards();
            initMap();
        });
    </script>
</body>
</html>
